---
title: 베이지안 통계
date: 2023-03-09T18:29:00Z
draft: false
katex: true
---

# 수업 방향

베이즈 통계학의 사용처와 이를 설명하기 위한 기본 학습. 

# 수업 내용

## 조건부 확률

- 베이즈 통계학은 조건부 확률을 베이스로 하기 때문에, 이에 대한 개념이 필요.
- $P(A\cap B)=P(B)P(A|B)$
    - $P(A|B)$: B가 일어난 상황에서 A가 일어날 확률.
- 위의 수식을 이용하여 아래와 같이 주로 사용하게 될 수식을 만들수 있다.
    - $P(B|A)=P(B)\frac{P(A|B)}{P(A)}$
    - 위의 수식으로 A가 일어났을때 B를 알아낼 수 있다.
- 이 수식은 다음의 수식으로도 볼 수 있다.
    - $P(\theta|D)=P(\theta)\frac{P(D|\theta)}{P(D)}$

## 예시를 통해 알아보기

- 다음 예시를 통해 알아보자.
    - 발병률 10%, 양성 판정 후 확진 99%, 양성판정 후 비확진 1%일 때 양성 판정 후 실제로 걸릴 확률은?
    - 여기서 발병률은 사전확률, 검사 후 결과를 가능도라 한다. 이를 수식으로 나타내면 다음과 같다.
        - $P(\theta)=0.1,\ P(D|\theta)=0.99,\ P(D|\lnot\theta)=0.01$
    - 여기서 $P(D)$ 는 다른 공식이 있다. 참은 참끼리 거짓은 거짓끼리 묶어 곱한 후 더하는 것 이다.
        - $P(D)=0.99\times0.1+0.01\times0.9(P(\lnot\theta))=0.108$
    - $P(\theta|D)=0.1\times\frac{0.99}{0.108}=0.916$
- 위의 식을 통해 갱신된 사후 확률 즉, 이 행동을 한번 더 했을 때의 정확도를 측정 할 수 있다.
    - 마치 부트스트랩핑 같다.
    - 먼저 이전 확률을 사전 확률로 가져온다. $P(\theta)=0.916$
    - 나머지 확률은 같으니 사전 확률이 들어간 부분만 다시 계산 한다.
        - $P(D)=0.916\times0.99+0.084\times0.01=0.9076$
    - $P(\theta|D)=0.916\times\frac{0.99}{0.9076}=0.9997$
    - 두번 검사해서 양성 나온거면 포기하자.

## 그럼 이거 가지고 인과관계를 알수 있나?

- 섣불리 조건부 확률로 인과관계를 추론해서는 큰일난다.
- 인과관계는 데이터 분포의 변화에 영향을 덜 받는 모델을 만들기 위해 사용한다.
- 하지만 이를 방해하는 중첩요인이 있을 수 있다. 이를 제거해야 진짜 연관성이 나오게 된다.
- 이를 위해서는 domain 지식을 통해 data 내에서 중첩요인을 제거해야 한다.
    - 예시: 키와 IQ의 연관관계를 짓게 되면, 나이라는 중첩요인이 끼어들어 저 둘이 관계가 있다고 나오게 된다.
    - 이는 완전히 ~~bullshit~~이 되어버린다.
